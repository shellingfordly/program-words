import{ac as P,c as z,n as w,m as E,l as L,d as C,r as v,ad as B,M as m,ae as R,o as N,O as U,b as o,U as p,af as _,w as y}from"./index.55e20e69.js";import{u as A}from"./index.70b84071.js";import{i as M,L as j}from"./index.1b14d3ef.js";const F=Symbol(),H=()=>P(F,null),[I,r,K]=z("list"),O={error:Boolean,offset:w(300),loading:Boolean,finished:Boolean,errorText:String,direction:E("down"),loadingText:String,finishedText:String,immediateCheck:L};var V=C({name:I,props:O,emits:["load","update:error","update:loading"],setup(e,{emit:c,slots:n}){const l=v(!1),f=v(),h=v(),s=H(),g=B(f),i=()=>{p(()=>{if(l.value||e.finished||e.error||(s==null?void 0:s.value)===!1)return;const{offset:t,direction:d}=e,a=_(g);if(!a.height||M(f))return;let u=!1;const x=_(h);d==="up"?u=a.top-x.top<=t:u=x.bottom-a.bottom<=t,u&&(l.value=!0,c("update:loading",!0),c("load"))})},T=()=>{if(e.finished){const t=n.finished?n.finished():e.finishedText;if(t)return o("div",{class:r("finished-text")},[t])}},b=()=>{c("update:error",!1),i()},S=()=>{if(e.error){const t=n.error?n.error():e.errorText;if(t)return o("div",{role:"button",class:r("error-text"),tabindex:0,onClick:b},[t])}},k=()=>{if(l.value&&!e.finished)return o("div",{class:r("loading")},[n.loading?n.loading():o(j,{class:r("loading-icon")},{default:()=>[e.loadingText||K("loading")]})])};return m(()=>[e.loading,e.finished,e.error],i),s&&m(s,t=>{t&&i()}),R(()=>{l.value=e.loading}),N(()=>{e.immediateCheck&&i()}),A({check:i}),U("scroll",i,{target:g,passive:!0}),()=>{var t;const d=(t=n.default)==null?void 0:t.call(n),a=o("div",{ref:h,class:r("placeholder")},null);return o("div",{ref:f,role:"feed",class:r(),"aria-busy":l.value},[e.direction==="down"?d:a,k(),T(),S(),e.direction==="up"?d:a])}}});const G=y(V);export{G as L};
